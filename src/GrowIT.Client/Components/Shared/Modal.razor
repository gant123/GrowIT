@namespace GrowIT.Client.Components.Shared

<div class="modal-overlay @(IsOpen ? "open" : "")" @onclick="HandleOverlayClick">
    <div class="modal @SizeClass" @onclick:stopPropagation="true">
        <div class="modal-header">
            <h2 class="modal-title">@Title</h2>
            @if (ShowCloseButton)
            {
                <button class="modal-close" @onclick="Close" aria-label="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            }
        </div>
        
        @if (ChildContent != null)
        {
            <div class="modal-body">
                @ChildContent
            </div>
        }
        
        @if (FooterContent != null)
        {
            <div class="modal-footer">
                @FooterContent
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public bool IsOpen { get; set; }
    [Parameter] public EventCallback<bool> IsOpenChanged { get; set; }
    [Parameter] public string Title { get; set; } = "";
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public RenderFragment? FooterContent { get; set; }
    [Parameter] public bool ShowCloseButton { get; set; } = true;
    [Parameter] public bool CloseOnOverlayClick { get; set; } = true;
    [Parameter] public ModalSize Size { get; set; } = ModalSize.Medium;
    [Parameter] public EventCallback OnClose { get; set; }

    private string SizeClass => Size switch
    {
        ModalSize.Small => "modal-sm",
        ModalSize.Large => "modal-lg",
        ModalSize.XLarge => "modal-xl",
        ModalSize.FullScreen => "modal-fullscreen",
        _ => ""
    };

    private async Task Close()
    {
        await IsOpenChanged.InvokeAsync(false);
        await OnClose.InvokeAsync();
    }

    private async Task HandleOverlayClick()
    {
        if (CloseOnOverlayClick)
        {
            await Close();
        }
    }

    public enum ModalSize
    {
        Small,
        Medium,
        Large,
        XLarge,
        FullScreen
    }
}
