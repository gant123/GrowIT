@page "/test"
@page "/dashboard"
@using GrowIT.Client.Services
@using GrowIT.Shared.DTOs
@inject IDashboardService DashboardService

<PageTitle>Dashboard - grow.IT</PageTitle>

<div class="container-fluid mt-4">
    <h1 class="h3 fw-bold mb-4">Executive Dashboard</h1>

    @if (_isLoading)
    {
        <div class="text-center"><div class="spinner-border text-primary"></div></div>
    }
    else
    {
        <div class="row g-4 mb-4">
            <div class="col-md-3">
                <div class="card h-100 border-0 shadow-sm p-3">
                    <small class="text-muted text-uppercase fw-bold">Total Clients</small>
                    <div class="display-6 fw-bold text-dark">@_stats.TotalClients</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card h-100 border-0 shadow-sm p-3">
                    <small class="text-muted text-uppercase fw-bold">Invested YTD</small>
                    <div class="display-6 fw-bold text-success">@_stats.TotalInvested.ToString("C0")</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card h-100 border-0 shadow-sm p-3">
                    <small class="text-muted text-uppercase fw-bold">Milestones</small>
                    <div class="display-6 fw-bold text-primary">@_stats.TotalMilestones</div>
                </div>
            </div>
        </div>
    }
</div>

@code {
    private DashboardStatsDto _stats = new();
    private bool _isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            _stats = await DashboardService.GetStatsAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error: {ex.Message}");
        }
        finally
        {
            _isLoading = false;
        }
    }
}